{{ template "base" . }}

{{ define "content" }}
<!-- Page Header -->
<header class="header">
    <div class="logo">
        <i class="fas fa-list"></i>
        <h1>监控列表</h1>
    </div>
    <div class="header-actions">
        <button class="btn btn-primary" onclick="showAddModal()">
            <i class="fas fa-plus"></i> 添加监控
        </button>
        <button class="btn btn-secondary" onclick="refreshData()">
            <i class="fas fa-sync-alt"></i> 刷新
        </button>
    </div>
</header>

<!-- Stats Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon up">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-info">
            <h3 id="stat-up">0</h3>
            <p>在线监控</p>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon down">
            <i class="fas fa-times-circle"></i>
        </div>
        <div class="stat-info">
            <h3 id="stat-down">0</h3>
            <p>离线监控</p>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon total">
            <i class="fas fa-list"></i>
        </div>
        <div class="stat-info">
            <h3 id="stat-total">0</h3>
            <p>总监控数</p>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon avg">
            <i class="fas fa-tachometer-alt"></i>
        </div>
        <div class="stat-info">
            <h3 id="stat-avg">0ms</h3>
            <p>平均响应时间</p>
        </div>
    </div>
</div>

<!-- Main Content Grid -->
<div class="main-content">
    <!-- Monitors Section -->
    <div class="section">
        <div class="section-header">
            <h2>监控列表</h2>
        </div>
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th>名称</th>
                        <th>类型</th>
                        <th>地址</th>
                        <th>状态</th>
                        <th>响应时间</th>
                        <th>正常运行时间</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="monitors-tbody">
                    <tr>
                        <td colspan="7" class="loading">
                            <i class="fas fa-spinner"></i>
                            <div>加载中...</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- IP Geo Section -->
    <div class="section">
        <div class="section-header">
            <h2>IP 地理位置查询</h2>
        </div>
        <div class="form-group">
            <div style="display: flex; gap: var(--spacing-3);">
                <input type="text" id="ip-input" placeholder="输入 IP 地址 (例如: 8.8.8.8)" style="flex: 1;">
                <button class="btn btn-primary" onclick="queryIPGeo()">
                    <i class="fas fa-search"></i> 查询
                </button>
            </div>
        </div>
        <div id="ipgeo-result" style="display: none;">
            <div style="background: var(--color-gray-50); border-radius: var(--radius-lg); padding: var(--spacing-5);">
                <div id="geo-info" style="display: flex; flex-direction: column; gap: var(--spacing-3);"></div>
            </div>
        </div>
    </div>
</div>
{{ end }}

{{ define "scripts" }}
<script src="/static/js/dashboard.js"></script>
<script>
    // IP Geo query result display
    function displayIPGeoResult(data) {
        const resultDiv = document.getElementById('ipgeo-result');
        const infoDiv = document.getElementById('geo-info');

        resultDiv.style.display = 'block';
        infoDiv.innerHTML = '';

        const fields = [
            { label: 'IP 地址', value: data.ip },
            { label: '国家', value: data.country },
            { label: '地区', value: data.region },
            { label: '城市', value: data.city },
            { label: 'ISP', value: data.isp },
            { label: '坐标', value: `${data.lat}, ${data.lon}` }
        ];

        fields.forEach(field => {
            const item = document.createElement('div');
            item.style.cssText = 'display: flex; justify-content: space-between; padding: var(--spacing-2) 0; border-bottom: 1px solid var(--color-gray-200);';
            item.innerHTML = `
                <label style="font-weight: var(--font-semibold); color: var(--color-gray-700);">${field.label}:</label>
                <span style="color: var(--color-gray-900);">${field.value || '-'}</span>
            `;
            infoDiv.appendChild(item);
        });
    }
</script>
{{ end }}
